<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Canvas Diagramm</title>
		<link rel="icon" type="image/x-icon" href="/images/favicon.ico">
		<link rel="stylesheet" href="style.css">

		<style>

		</style>
	</head>
	<body>
		<div class="titel">
			<h1 class="titel-font" >Wochenstatistik:</h1>
		</div>

		<div class="spacer"></div>
		<canvas style="background-color: white" id="myChart"></canvas>
		<div class="spacer"></div>

		<div style="display: flex">
			<a class="m-btn auswahlLink m-btn-green" href="/wochenstatus.html">Alle Artikel</a>
			<a class="m-btn auswahlLink m-btn-green" href="/wochenstatus-kategorie.html">Nach Kategorie</a>
			<a class="m-btn auswahlLink m-btn-green auswahlLinkSelected" href="/wochenstatus-hersteller.html"> &#128309; Nach Hersteller</a>
		</div>

		<div class="spacer"></div>
	<div class="row jc-left">
		<a class="m-btn m-btn-blue" href="/"> &#8962; Zur Startseite</a>
		<button class="m-btn-green m-btn btn-stacked-width row-block-distance-60" onclick="switchStacked()" id="stack-button" value="true" >Gestapelt</button>
	</div>
	<div class="pageEnd"></div>

		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<script >
			const ctx = document.getElementById('myChart').getContext('2d');
			let delayed;
			const myChart = new Chart(ctx, {
				type: 'bar',
				data: {
					labels: ['Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag', 'Sonntag'],
					datasets: [ %DATA_DATA_SETS% ]
				},
				options: {
					animation: {
				    	onComplete: () => {
					    	delayed = true;
				    	},
				    	delay: (context) => {
						let delay = 0;
						if (context.type === 'data' && context.mode === 'default' && !delayed) {
					  		delay = context.dataIndex * 50 + context.datasetIndex * 25;
						}
						return delay;
				    	},
					},
					scales: {
				  		x: {
				  			stacked: true,
				  		},
				  		y: {
							stacked: true,
							beginAtZero: true
				  		}
					}
				}
			});
			var toggleStackedBtn = function(buttonName, chart) {
				button = document.getElementById(buttonName);
				if( button.value == "true" ) {
					button.value = "false";
					button.textContent = "Nebeneinander";
					button.classList.remove("m-btn-green")
					button.classList.add("m-btn-blue")

				 	chart.options.scales.x.stacked = false;
				 	chart.options.scales.y.stacked = false;

				} else {
					button.value = "true"
					button.textContent = "Gestapelt";
					button.classList.remove("m-btn-blue")
					button.classList.add("m-btn-green")

					chart.options.scales.x.stacked = true;
					chart.options.scales.y.stacked = true;
				}
				chart.update();
			};

		function switchStacked() {
			toggleStackedBtn("stack-button", myChart);
		}
		</script>

		</body>
</html>